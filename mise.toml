[tasks."docs:build"]
description = "Build HTML documentation"
run = "uv run --group docs sphinx-build -b html docs docs/build/html"

[tasks."docs:clean"]
description = "Clean documentation build"
run = "rm -rf docs/build"

[tasks."docs:serve"]
description = "Build and serve docs locally"
run = """
uv run --group docs sphinx-build -b html docs docs/build/html
python -m http.server -d docs/build/html 8000
"""

[tasks."test:fixtures"]
description = "Generate OCR test fixtures from source images"
dir = "tests"
run = "make clean && make"

[tasks."test:regenerate-pdf-baselines"]
description = "Regenerate PDF test baseline files with current library versions"
run = """
uv run python -c "
import pathlib
import shutil
import textract

pdf_dir = pathlib.Path('tests/pdf')

result = textract.process(str(pdf_dir / 'raw_text.pdf'))
(pdf_dir / 'raw_text.txt').write_bytes(result)
print('Regenerated: raw_text.txt')

if shutil.which('pdftotext'):
    result = textract.process(str(pdf_dir / 'raw_text.pdf'), method='pdftotext')
    (pdf_dir / 'raw_text-m=pdftotext.txt').write_bytes(result)
    print('Regenerated: raw_text-m=pdftotext.txt')
else:
    print('Skipped: raw_text-m=pdftotext.txt (pdftotext not installed)')

result = textract.process(str(pdf_dir / 'raw_text.pdf'), method='pdfminer')
(pdf_dir / 'raw_text-m=pdfminer.txt').write_bytes(result)
print('Regenerated: raw_text-m=pdfminer.txt')

result = textract.process(str(pdf_dir / 'two_column.pdf'), layout=True)
(pdf_dir / 'two_column.txt').write_bytes(result)
print('Regenerated: two_column.txt')

print('Done!')
"
"""

[tasks."changelog:preview"]
description = "Preview unreleased changelog entries"
run = "./scripts/prepend-changelog.sh --preview"

[tasks."changelog:update"]
description = "Update changelog with newly released version (run after cz bump)"
run = "./scripts/prepend-changelog.sh"

[tasks."release:bump"]
description = "Bump version (usage: mise run release:bump -- --increment PATCH|MINOR|MAJOR)"
run = "uv run cz bump"

[tools]
python = "3.14"
